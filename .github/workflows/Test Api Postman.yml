name: Test API with Postman

on: [push]

jobs:
  test-api:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    
     # INstall Node on the runner
    - name: Install Node
      uses: actions/setup-node@v1
      with:
        node-version: "16.x"

    - name: Install Newman and dependencies
      run: |
        npm install -g newman
        npm install 
 # Make directory to upload the test results
    - name: Make Directory for results
      run: mkdir -p testResults

    - name: Run Postman collection
      run: |
        newman run newman/TaHouse.postman_collection.json -e newman/Ta_House.postman_environment.json -r cli,html

     # Upload the contents of Test Results directory to workspace
    - name: Output the run Details
      uses: actions/upload-artifact@v2
      with:
        name: RunReports
        path: testResults